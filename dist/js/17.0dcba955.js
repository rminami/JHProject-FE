webpackJsonp([17],{EOQp:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("mJx5");var n=i("Biqn"),o=i.n(n),a=i("NYxO"),s=i("mtWM"),l=i.n(s),r=i("o/zv"),c=i.n(r),u=i("162o"),f=i("cIsK"),v={components:{"file-dialog":f["default"]},data:function(){return{currentPath:"",dirs:[],files:[],textDialog:!1,fileDialogIsOpen:!1,fileDialogMode:"",snackbar:{text:"",color:"",isOpen:!1},selectedItem:""}},watch:{$route:function(){this.currentPath=this.$route.path,this.getFiles()}},created:function(){this.currentPath=this.$route.path,this.getFiles()},computed:o()({pathInProject:function(){return"/".concat(this.currentPath.split("/").slice(4).join("/"))},parentDirs:function(){var t=this,e=this.$route.path.split("/").slice(3);return e.map(function(i,n){return{text:decodeURIComponent(i),path:"/projects/".concat(t.$route.params.project_name,"/").concat(e.slice(0,n+1).join("/"))}})}},Object(a["b"])({beEndpoint:function(t){return t.beEndpoint},currentProject:function(t){return t.currentProject}})),methods:{getFiles:function(){var t=this;l()({baseURL:this.beEndpoint,url:"".concat(this.currentPath,"/"),params:{view:"meta",include_children:!0}}).then(function(e){var i=t.attachIcons(e.data.data.children);t.dirs=i.filter(function(t){return"directory"===t.type}),t.files=i.filter(function(t){return"directory"!==t.type})}).catch(function(e){console.log(e.response),t.snackbar.text="Could not connect to backend server.",t.snackbar.color="error",t.snackbar.isOpen=!0})},attachIcons:function(t){return t.map(function(t){var e=t;switch(e.type){case"directory":return o()({},e,{icon:"folder",iconClass:"grey lighten-1 white--text"});case"tabular":return o()({},e,{icon:"storage",iconClass:"blue white--text"});case"scalable_image":return o()({},e,{icon:"image",iconClass:"amber white--text"});default:return o()({},e,{icon:"note",iconClass:"teal white--text"})}})},startCopyFile:function(t){this.fileDialogIsOpen=!0,this.selectedItem=t,this.fileDialogMode="copy"},startMoveFile:function(t){this.fileDialogIsOpen=!0,this.selectedItem=t,this.fileDialogMode="move"},handleDirectorySelect:function(t){var e=this,i=this.selectedItem,n=this.fileDialogMode;Object(u["setTimeout"])(function(){e.selectedItem="",e.fileDialogMode=""},1e3),this.fileDialogIsOpen=!1,t!==this.pathInProject?l()({method:"post",baseURL:this.beEndpoint,url:c.a.join(this.currentPath,i),params:{action:n},data:{path:t}}).then(function(o){e.snackbar.text="'".concat(i,"' has been \n          ").concat("copy"===n?"copied":"moved"," to ").concat(t,"."),e.snackbar.color="success",e.snackbar.isOpen=!0,"move"===n&&(e.dirs=e.dirs.filter(function(t){return t.file_name!==i}),e.files=e.files.filter(function(t){return t.file_name!==i}))}).catch(function(o){e.snackbar.text="'".concat(i,"' could not be \n          ").concat("copy"===n?"copied":"moved"," to ").concat(t,"."),e.snackbar.color="error",e.snackbar.isOpen=!0}):(this.snackbar.text="File cannot be copied into the same directory.",this.snackbar.color="error",this.snackbar.isOpen=!0)},downloadFile:function(t){l()({method:"get",baseURL:this.beEndpoint,url:c.a.join(this.currentPath,t),params:{view:"raw"},responseType:"blob"}).then(function(t){var e=window.URL.createObjectURL(new Blob([t.data])),i=document.createElement("a");i.href=e,i.setAttribute("download",fileName),document.body.appendChild(i),i.click(),i.remove()})},deleteFile:function(t){var e=this;l()({method:"post",baseURL:this.beEndpoint,url:c.a.join(this.currentPath,t),params:{action:"delete"}}).then(function(i){e.snackbar.text="'".concat(t,"' has been deleted."),e.snackbar.color="success",e.snackbar.isOpen=!0,e.dirs=e.dirs.filter(function(e){return e.file_name!==t}),e.files=e.files.filter(function(e){return e.file_name!==t})}).catch(function(i){e.snackbar.text="'".concat(t,"' could not be deleted."),e.snackbar.color="error",e.snackbar.isOpen=!0})},toggleDialog:function(){this.textDialog=!this.textDialog}},name:"FileBrowse"},d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{attrs:{xs10:"","offset-xs1":""}},[i("v-breadcrumbs",[i("v-icon",{attrs:{slot:"divider"},slot:"divider"},[t._v("chevron_right")]),t._l(t.parentDirs,function(e,n){return i("v-breadcrumbs-item",{key:n,attrs:{to:e.path,exact:!0}},[t._v("\n      "+t._s(e.text)+"\n    ")])})],2),i("v-list",{attrs:{"two-line":""}},[i("v-subheader",{directives:[{name:"show",rawName:"v-show",value:t.dirs.length>0,expression:"dirs.length > 0"}],attrs:{inset:""}},[t._v("Folders")]),t._l(t.dirs,function(e){return i("v-list-tile",{key:e.id,attrs:{avatar:""},on:{click:function(i){t.$router.push("/projects/"+t.$route.params.project_name+"/files/"+e.file_path)}}},[i("v-list-tile-avatar",[i("v-icon",{class:[e.iconClass]},[t._v(t._s(e.icon))])],1),i("v-list-tile-content",[i("v-list-tile-title",[t._v(t._s(e.file_name))])],1),i("v-list-tile-action",{on:{click:function(t){t.stopPropagation()}}},[i("v-menu",{attrs:{bottom:"",left:""}},[i("v-btn",{attrs:{slot:"activator",icon:"",dark:"",ripple:""},slot:"activator"},[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("more_vert")])],1),i("v-list",[i("v-list-tile",{on:{click:function(e){e.stopPropagation(),t.downloadFile(t.file.file_name)}}},[i("v-list-tile-title",[t._v("Download")])],1),i("v-list-tile",{on:{click:function(i){i.stopPropagation(),t.startCopyFile(e.file_name)}}},[i("v-list-tile-title",[t._v("Copy")])],1),i("v-list-tile",{on:{click:function(i){i.stopPropagation(),t.startMoveFile(e.file_name)}}},[i("v-list-tile-title",[t._v("Move")])],1),i("v-list-tile",{on:{click:function(i){i.stopPropagation(),t.deleteFile(e.file_name)}}},[i("v-list-tile-title",[t._v("Delete")])],1)],1)],1)],1)],1)}),i("v-divider",{directives:[{name:"show",rawName:"v-show",value:t.dirs.length>0&&t.files.length>0,expression:"dirs.length > 0 && files.length > 0"}],attrs:{inset:""}}),i("v-subheader",{directives:[{name:"show",rawName:"v-show",value:t.files.length>0,expression:"files.length > 0"}],attrs:{inset:""}},[t._v("Files")]),t._l(t.files,function(e){return i("v-list-tile",{key:e.id,attrs:{avatar:""},on:{click:function(i){t.$router.push("/projects/"+t.$route.params.project_name+"/files/"+e.file_path)}}},[i("v-list-tile-avatar",[i("v-icon",{class:[e.iconClass]},[t._v(t._s(e.icon))])],1),i("v-list-tile-content",[i("v-list-tile-title",[t._v(t._s(e.file_name))])],1),i("v-list-tile-action",{on:{click:function(t){t.stopPropagation()}}},[i("v-menu",{attrs:{bottom:"",left:""}},[i("v-btn",{attrs:{slot:"activator",icon:"",dark:"",ripple:""},slot:"activator"},[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("more_vert")])],1),i("v-list",[i("v-list-tile",{on:{click:function(i){i.stopPropagation(),t.downloadFile(e.file_name)}}},[i("v-list-tile-title",[t._v("Download")])],1),i("v-list-tile",{on:{click:function(i){i.stopPropagation(),t.startCopyFile(e.file_name)}}},[i("v-list-tile-title",[t._v("Copy")])],1),i("v-list-tile",{on:{click:function(i){i.stopPropagation(),t.startMoveFile(e.file_name)}}},[i("v-list-tile-title",[t._v("Move")])],1),i("v-list-tile",{on:{click:function(i){i.stopPropagation(),t.deleteFile(e.file_name)}}},[i("v-list-tile-title",[t._v("Delete")])],1)],1)],1)],1)],1)}),i("v-alert",{attrs:{value:0===t.dirs.length&&0===t.files.length,color:"info",icon:"info",outline:""}},[t._v("\n      No files in current directory.\n    ")])],2),i("v-dialog",{attrs:{scrollable:"","max-width":"500px"},model:{value:t.fileDialogIsOpen,callback:function(e){t.fileDialogIsOpen=e},expression:"fileDialogIsOpen"}},[i("file-dialog",{attrs:{initialPath:t.currentPath,mode:t.fileDialogMode},on:{select:t.handleDirectorySelect,close:function(e){t.fileDialogIsOpen=!1}}})],1),i("v-snackbar",{attrs:{timeout:3e3,color:t.snackbar.color},model:{value:t.snackbar.isOpen,callback:function(e){t.$set(t.snackbar,"isOpen",e)},expression:"snackbar.isOpen"}},[t._v("\n    "+t._s(t.snackbar.text)+"\n    "),i("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(e){t.snackbar.isOpen=!1}}},[t._v("Close")])],1)],1)},p=[],h=i("XyMi");function m(t){i("uniA")}var b=!1,g=m,_="data-v-2e1aaf30",k=null,w=Object(h["a"])(v,d,p,b,g,_,k);e["default"]=w.exports},uniA:function(t,e){}});
//# sourceMappingURL=17.0dcba955.js.map